# æ¨å¸æœºæ¸¸æˆåç«¯é…ç½®æ–‡ä»¶
# å¤åˆ¶æ­¤æ–‡ä»¶ä¸º config.yaml å¹¶æ ¹æ®å®é™…ç¯å¢ƒä¿®æ”¹é…ç½®

# æœåŠ¡å™¨é…ç½®
server:
  host: "0.0.0.0"
  port: 8080
  mode: "development" # development, production, test
  read_timeout: 30s
  write_timeout: 30s
  shutdown_timeout: 10s

# æ•°æ®åº“é…ç½®
database:
  # é€‚é…å™¨ç±»å‹: "standalone" (å•æœºç‰ˆ) æˆ– "online" (çº¿ä¸Šç‰ˆ)
  adapter_type: "standalone"
  
  # åŸæœ‰é…ç½®ï¼ˆç”¨äºå…¼å®¹ï¼‰
  driver: "sqlite"
  dsn: "./data/slot-game.db"
  max_idle_conns: 10
  max_open_conns: 100
  conn_max_lifetime: 1h
  log_level: "info" # silent, error, warn, info
  auto_migrate: true
  
  # å•æœºç‰ˆé…ç½®ï¼ˆSQLiteï¼‰
  standalone:
    path: "./data/slot-game.db"
  
  # çº¿ä¸Šç‰ˆé…ç½®ï¼ˆPostgreSQL + Redisï¼‰- æš‚æœªå¯ç”¨
  online:
    postgresql:
      host: "localhost"
      port: 5432
      user: "slot_game"
      password: "password"
      database: "slot_game_db"
      ssl_mode: "disable"
      max_conns: 25
    redis:
      host: "localhost"
      port: 6379
      password: ""
      db: 0
      pool_size: 10

# WebSocketé…ç½®
# æ³¨æ„ï¼šå½“å‰WebSocketé€šè¿‡ä¸»HTTPæœåŠ¡å™¨æä¾›ï¼ˆç«¯å£8080çš„/wsè·¯å¾„ï¼‰
# ä¸‹é¢çš„ç‹¬ç«‹ç«¯å£é…ç½®æš‚æœªä½¿ç”¨
websocket:
  host: "0.0.0.0"
  port: 8081  # æœªä½¿ç”¨ - WebSocketå®é™…é€šè¿‡ http://localhost:8080/ws/game è®¿é—®
  path: "/ws"
  read_buffer_size: 1024
  write_buffer_size: 1024
  max_message_size: 8192
  ping_interval: 30s
  pong_timeout: 60s
  write_timeout: 10s
  enable_compression: true

# ä¸²å£é…ç½®
serial:
  enabled: true          # æ˜¯å¦å¯ç”¨ä¸²å£ï¼ˆfalseæ—¶ä½¿ç”¨æ¨¡æ‹Ÿæ§åˆ¶å™¨ï¼‰
  
  # STM32ç¡¬ä»¶ä¸²å£
  stm32:
    enabled: true          # æ˜¯å¦å¯ç”¨ä¸²å£ï¼ˆfalseæ—¶ä½¿ç”¨æ¨¡æ‹Ÿæ§åˆ¶å™¨ï¼‰
    port: "/dev/ttyS3"    # Linuxç³»ç»Ÿä¸²å£ï¼ŒWindowsä½¿ç”¨COM1ç­‰
    baud_rate: 115200       # å®é™…æ³¢ç‰¹ç‡ï¼ˆæ³¨æ„base_baudå½±å“ï¼‰
    data_bits: 8
    stop_bits: 2
    parity: "N"
    read_timeout: 100ms
    write_timeout: 100ms
    retry_times: 3
    retry_interval: 500ms
    heartbeat_interval: 30s
  
  # ACMç®—æ³•æ¨¡å—ä¸²å£
  acm:
    enabled: true         # æ˜¯å¦å¯ç”¨ACMè®¾å¤‡
    port: "auto"          # "auto"è‡ªåŠ¨æ£€æµ‹ï¼Œæˆ–æŒ‡å®šå¦‚"/dev/ttyACM0"
    baud_rate: 115200
    data_bits: 8
    stop_bits: 2
    parity: "N"           # N-æ— æ ¡éªŒ
    read_timeout: 100ms
    write_timeout: 100ms
    auto_detect: true     # è‡ªåŠ¨æ£€æµ‹ACMè®¾å¤‡
  
  # æ¡¥æ¥æ¨¡å¼é…ç½®
  bridge:
    enabled: false         # å¯ç”¨ACM<->STM32æ¡¥æ¥
    log_messages: false   # æ˜¯å¦è®°å½•æ¡¥æ¥æ¶ˆæ¯

# MQTTé…ç½®
mqtt:
  enabled: true
  broker: "tcp://localhost:1883"
  client_id: "slot-game-001"
  username: ""
  password: ""
  qos: 1
  retained: false
  clean_session: true
  auto_reconnect: true
  max_reconnect_interval: 1m
  keep_alive: 60s
  ping_timeout: 10s
  topics:
    status: "device/{client_id}/status"
    command: "device/{client_id}/command"
    config: "device/{client_id}/config"
    event: "device/{client_id}/event"

# æ¸¸æˆé…ç½®
game:
  # è€è™æœºé…ç½®
  slot:
    reels: 3 # è½¬è½®æ•°é‡
    symbols: ["ğŸ’", "ğŸ‹", "ğŸŠ", "ğŸ‰", "â­", "ğŸ’", "7ï¸âƒ£"]
    spin_duration: 3s
    
    # ä¸­å¥–æ¦‚ç‡é…ç½® (æ€»å’Œåº”ä¸º100%)
    win_rates:
      jackpot: 0.1   # å¤§å¥– 0.1%
      big_win: 1.0   # å¤§èµ¢ 1%
      medium_win: 5.0 # ä¸­ç­‰å¥–åŠ± 5%
      small_win: 20.0 # å°å¥– 20%
      no_win: 73.9   # ä¸ä¸­å¥– 73.9%
    
    # å¥–åŠ±å€æ•°é…ç½®
    payouts:
      "7ï¸âƒ£,7ï¸âƒ£,7ï¸âƒ£": 100    # ä¸‰ä¸ª7
      "ğŸ’,ğŸ’,ğŸ’": 50      # ä¸‰ä¸ªé’»çŸ³
      "â­,â­,â­": 30      # ä¸‰ä¸ªæ˜Ÿæ˜Ÿ
      "ğŸ‰,ğŸ‰,ğŸ‰": 20      # ä¸‰ä¸ªè¥¿ç“œ
      "ğŸŠ,ğŸŠ,ğŸŠ": 15      # ä¸‰ä¸ªæ©™å­
      "ğŸ‹,ğŸ‹,ğŸ‹": 10      # ä¸‰ä¸ªæŸ æª¬
      "ğŸ’,ğŸ’,ğŸ’": 5       # ä¸‰ä¸ªæ¨±æ¡ƒ
  
  # æ¨å¸æœºé…ç½®
  pusher:
    default_force: 50      # é»˜è®¤æ¨å¸åŠ›åº¦ (0-100)
    min_force: 20         # æœ€å°æ¨å¸åŠ›åº¦
    max_force: 100        # æœ€å¤§æ¨å¸åŠ›åº¦
    push_duration: 500ms  # å•æ¬¡æ¨å¸æŒç»­æ—¶é—´
    push_interval: 1s     # æ¨å¸é—´éš”æ—¶é—´
    
    # æ ¹æ®ä¸­å¥–ç­‰çº§çš„æ¨å¸é…ç½®
    push_config:
      jackpot:
        count: 10      # æ¨å¸æ¬¡æ•°
        force: 100     # æ¨å¸åŠ›åº¦
      big_win:
        count: 5
        force: 80
      medium_win:
        count: 3
        force: 60
      small_win:
        count: 1
        force: 40
  
  # å¸æ•°ç®¡ç†é…ç½®
  coin:
    price_per_coin: 1.0   # æ¯ä¸ªå¸çš„ä»·æ ¼ï¼ˆå…ƒï¼‰
    min_bet: 1           # æœ€å°æŠ•æ³¨
    max_bet: 10          # æœ€å¤§æŠ•æ³¨
    initial_coins: 100   # åˆå§‹å¸æ•°
    max_coins: 10000     # æœ€å¤§å¸æ•°é™åˆ¶

# æ—¥å¿—é…ç½®
log:
  level: "info" # debug, info, warn, error, fatal
  format: "json" # json, console
  output: "both" # stdout, file, both
  file:
    path: "./logs"
    filename: "slot-game.log"
    max_size: 100 # MB
    max_age: 30 # days
    max_backups: 7
    compress: true
  
  # ä¸åŒæ¨¡å—çš„æ—¥å¿—çº§åˆ«
  modules:
    game: "debug"
    serial: "info"
    websocket: "info"
    mqtt: "info"
    database: "warn"

# ç›‘æ§é…ç½®
monitor:
  enabled: true
  metrics_interval: 10s
  health_check_interval: 30s
  
  # å‘Šè­¦é˜ˆå€¼
  alerts:
    cpu_threshold: 80      # CPUä½¿ç”¨ç‡å‘Šè­¦é˜ˆå€¼(%)
    memory_threshold: 80   # å†…å­˜ä½¿ç”¨ç‡å‘Šè­¦é˜ˆå€¼(%)
    error_rate: 10        # é”™è¯¯ç‡å‘Šè­¦é˜ˆå€¼(%)
    response_time: 1000   # å“åº”æ—¶é—´å‘Šè­¦é˜ˆå€¼(ms)

# å®‰å…¨é…ç½®
security:
  # APIé™æµé…ç½®
  rate_limit:
    enabled: true
    requests_per_minute: 60
    burst: 10
  
  # JWTé…ç½®ï¼ˆç”¨äºè¿œç¨‹ç®¡ç†ï¼‰
  jwt:
    secret: "change-this-secret-key-in-production"
    expire_hours: 24
    refresh_hours: 168 # 7 days
  
  # åŠ å¯†é…ç½®
  encryption:
    enabled: false
    algorithm: "AES-256-GCM"
    key: "change-this-encryption-key-in-production"

# ç³»ç»Ÿé…ç½®
system:
  # æ—¶åŒºè®¾ç½®
  timezone: "Asia/Shanghai"
  
  # æ€§èƒ½é…ç½®
  max_procs: 0 # 0è¡¨ç¤ºä½¿ç”¨æ‰€æœ‰CPUæ ¸å¿ƒ
  
  # ç¼“å­˜é…ç½®
  cache:
    enabled: true
    size: 1000
    ttl: 5m
    
  # å¤‡ä»½é…ç½®
  backup:
    enabled: true
    interval: 24h
    path: "./backups"
    keep_days: 7